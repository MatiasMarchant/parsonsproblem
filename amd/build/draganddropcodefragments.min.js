define("qtype_parsonsproblem/draganddropcodefragments",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=function(questionid,answerid){var dragItem=null,draggedOver=null,initX=null,endX=null,leavingColumn=null,enteringColumn=null,content="",leftColumn=document.getElementById("column"+questionid+"0"),rightColumn=document.getElementById("column"+questionid+"1"),answerObject=document.getElementById(answerid);leftColumn.addEventListener("dragover",dragOverColumn),leftColumn.addEventListener("dragenter",dragEnterColumn),leftColumn.addEventListener("dragleave",dragLeaveColumn),rightColumn.addEventListener("dragover",dragOverColumn),rightColumn.addEventListener("dragenter",dragEnterColumn),rightColumn.addEventListener("dragleave",dragLeaveColumn);var neighborhood=leftColumn.childNodes,answerneighborhood=rightColumn.childNodes;function clickChoice(){this.parentNode.childNodes.forEach((function(choice){choice.classList.remove("chosen-choice")})),this.classList.add("chosen-choice"),updateAnswer()}function dragStart(e){initX=e.clientX,dragItem=this}function dragEnd(){dragItem=null,updateAnswer()}function updateAnswer(){answerObject.value="",answerneighborhood.forEach((function(line){line.classList.contains("sortable-choice-parent")?line.childNodes.forEach((function(choice){choice.classList.contains("chosen-choice")&&(content=choice.innerHTML)})):content=line.innerHTML,content.split(/\r\n|\r|\n/g).forEach((function(contentline){var html,txt;answerObject.value=answerObject.value+"    ".repeat(line.currentIndentation)+(html=contentline,(txt=document.createElement("textarea")).innerHTML=html,txt.value)+"\r\n"})),answerObject.value=answerObject.value.slice(0,-2),answerObject.value=answerObject.value+"|/",content=""})),answerObject.value=answerObject.value.slice(0,-2)}function dragOver(e){e.preventDefault(),(draggedOver=e.target).classList.contains("sortable-choice")&&(draggedOver=draggedOver.parentNode),function(neighborhood){if(dragItem!=draggedOver){for(var currentpos=0,droppedpos=0,it=0;it<neighborhood.length;it++)dragItem==neighborhood[it]&&(currentpos=it),draggedOver==neighborhood[it]&&(droppedpos=it);currentpos<droppedpos?dragItem.parentNode.insertBefore(dragItem,draggedOver.nextSibling):dragItem.parentNode.insertBefore(dragItem,draggedOver)}}(draggedOver.parentNode.childNodes)}function dragOverColumn(e){e.preventDefault(),function(e){if((endX=e.clientX)>=initX+50){var indentations=Math.floor((endX-initX)/50);dragItem.style.marginLeft=50*(dragItem.currentIndentation+indentations)+"px",dragItem.currentIndentation=dragItem.currentIndentation+indentations,initX=endX}else{var _indentations=Math.floor(Math.abs(initX-endX)/50);dragItem.currentIndentation-_indentations<=0?(dragItem.style.marginLeft="0px",dragItem.currentIndentation=0):_indentations>=1&&(dragItem.style.marginLeft=50*(dragItem.currentIndentation-_indentations)+"px",dragItem.currentIndentation=dragItem.currentIndentation-_indentations,initX=endX)}}(e)}function dragEnterColumn(e){enteringColumn=this,null!==leavingColumn&&leavingColumn!==enteringColumn&&(this.isSameNode(leftColumn)?(leftColumn.appendChild(dragItem),initX=e.clientX,dragItem.currentIndentation=0,dragItem.style.marginLeft="0px"):this.isSameNode(rightColumn)&&(rightColumn.appendChild(dragItem),initX=e.clientX,dragItem.currentIndentation=0,dragItem.style.marginLeft="0px")),leavingColumn=null,enteringColumn=null}function dragLeaveColumn(){leavingColumn=this}neighborhood.forEach((function(codeFragment){if(codeFragment.draggable=!0,codeFragment.currentIndentation=0,codeFragment.addEventListener("dragstart",dragStart),codeFragment.addEventListener("dragend",dragEnd),codeFragment.addEventListener("dragover",dragOver),codeFragment.classList.contains("sortable-choice-parent")){var counter=0;codeFragment.childNodes.forEach((function(choice){0===counter&&choice.classList.add("chosen-choice"),choice.addEventListener("click",clickChoice),counter++}))}}))}}));

//# sourceMappingURL=draganddropcodefragments.min.js.map